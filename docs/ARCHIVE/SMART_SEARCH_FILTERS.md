# Intelligent Search Filter Detection - Backend Integration

## üìã –û–≥–ª—è–¥ –∑–∞–¥–∞—á—ñ

–î–æ–¥–∞–Ω–æ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ —Ä–æ–∑–ø—ñ–∑–Ω–∞–≤–∞–Ω–Ω—è –∫–æ–ª—å–æ—Ä—ñ–≤ —ñ —Ç–∏–ø—ñ–≤ –ø—Ä–æ–¥—É–∫—Ç—ñ–≤ —É –ø–æ—à—É–∫—É. –ö–æ–ª–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–≤–æ–¥–∏—Ç—å "black", "jacket", "—á–æ—Ä–Ω–∏–π" –∞–±–æ "–∫—É—Ä—Ç–∫–∞", —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—î –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫—É –∫–∞—Ç–∞–ª–æ–≥—É –∑ –∞–∫—Ç–∏–≤–Ω–∏–º —Ñ—ñ–ª—å—Ç—Ä–æ–º –∑–∞–º—ñ—Å—Ç—å –∑–≤–∏—á–∞–π–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –ø–æ—à—É–∫—É.

## ‚úÖ –©–æ –∑—Ä–æ–±–ª–µ–Ω–æ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—ñ

### 1. –°—Ç–≤–æ—Ä–µ–Ω–æ —É—Ç–∏–ª—ñ—Ç—É `src/utils/searchFilters.ts`

–¶—è —É—Ç–∏–ª—ñ—Ç–∞ –º—ñ—Å—Ç–∏—Ç—å:
- **`detectSearchFilter(query: string)`** - –≥–æ–ª–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è —Ä–æ–∑–ø—ñ–∑–Ω–∞–≤–∞–Ω–Ω—è
- –ü—ñ–¥—Ç—Ä–∏–º–∫—É –∫–æ–ª—å–æ—Ä—ñ–≤: Black, White, Gray, Blue, Red, Green, Yellow, Orange, Pink, Purple, Brown, Beige, Navy, Maroon, Olive, Cream
- –ü—ñ–¥—Ç—Ä–∏–º–∫—É —Ç–∏–ø—ñ–≤: jackets, hoodies, T-shirts, pants, jeans, shorts, shoes, accessories
- **–ë–∞–≥–∞—Ç–æ–º–æ–≤–Ω—ñ—Å—Ç—å**: –ø–æ–≤–Ω–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∞ –∞–Ω–≥–ª—ñ–π—Å—å–∫–æ—ó —Ç–∞ —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—ó –º–æ–≤

### 2. –û–Ω–æ–≤–ª–µ–Ω–æ –ª–æ–≥—ñ–∫—É –ø–æ—à—É–∫—É `SearchDropdownContainer.tsx`

–ü—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ Enter –∞–±–æ "View All":
- –°–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª—ñ–∑—É—î –∑–∞–ø–∏—Ç —á–µ—Ä–µ–∑ `detectSearchFilter()`
- –Ø–∫—â–æ –∑–Ω–∞–π–¥–µ–Ω–æ –∫–æ–ª—ñ—Ä ‚Üí –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –Ω–∞ `/products?color=Black`
- –Ø–∫—â–æ –∑–Ω–∞–π–¥–µ–Ω–æ —Ç–∏–ø ‚Üí –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –Ω–∞ `/products?type=jackets`
- –Ø–∫—â–æ –Ω—ñ—á–æ–≥–æ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ ‚Üí –∑–≤–∏—á–∞–π–Ω–∏–π –ø–æ—à—É–∫ `/products?search=query`

### 3. –ü—Ä–∏–∫–ª–∞–¥–∏ —Ä–æ–±–æ—Ç–∏

```
–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–≤–æ–¥–∏—Ç—å: "black"
‚Üí –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è: /products?color=Black

–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–≤–æ–¥–∏—Ç—å: "jacket"
‚Üí –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è: /products?type=jackets

–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–≤–æ–¥–∏—Ç—å: "—á–æ—Ä–Ω–∏–π"
‚Üí –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è: /products?color=Black

–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–≤–æ–¥–∏—Ç—å: "–∫—É—Ä—Ç–∫–∞"
‚Üí –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è: /products?type=jackets

–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–≤–æ–¥–∏—Ç—å: "nike air max"
‚Üí –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è: /products?search=nike+air+max
```

## üîß –©–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑—Ä–æ–±–∏—Ç–∏ –Ω–∞ –±–µ–∫–µ–Ω–¥—ñ (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)

### –û–ø—Ü—ñ—è 1: –ù—ñ—á–æ–≥–æ –Ω–µ —Ä–æ–±–∏—Ç–∏ ‚úÖ
–ü–æ—Ç–æ—á–Ω—ñ –µ–Ω–¥–ø–æ—ñ–Ω—Ç–∏ `/api/v1/pages/products` –≤–∂–µ –ø—Ä–∏–π–º–∞—é—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ `color` —ñ `type`, —Ç–æ–º—É –≤—Å–µ –ø—Ä–∞—Ü—é—î!

### –û–ø—Ü—ñ—è 2: –ü–æ–∫—Ä–∞—â–∏—Ç–∏ –ø–æ—à—É–∫ (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ)

–Ø–∫—â–æ —Ö–æ—á–µ—Ç–µ –∑—Ä–æ–±–∏—Ç–∏ –ø–æ—à—É–∫ —Ä–æ–∑—É–º–Ω—ñ—à–∏–º, –º–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏ –ª–æ–≥—ñ–∫—É —Å–µ—Ä–≤–µ—Ä–Ω–æ—ó –¥–µ—Ç–µ–∫—Ü—ñ—ó:

#### 1. –î–æ–¥–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—é —Ä–æ–∑–ø—ñ–∑–Ω–∞–≤–∞–Ω–Ω—è –Ω–∞ –±–µ–∫–µ–Ω–¥—ñ

```python
# utils/search_detection.py

COLOR_MAPPINGS = {
    # English
    'black': 'Black',
    'white': 'White',
    'gray': 'Gray',
    'grey': 'Gray',
    'blue': 'Blue',
    'red': 'Red',
    'green': 'Green',
    'yellow': 'Yellow',
    'orange': 'Orange',
    'pink': 'Pink',
    'purple': 'Purple',
    'brown': 'Brown',
    'beige': 'Beige',
    'navy': 'Navy',
    'maroon': 'Maroon',
    'olive': 'Olive',
    'cream': 'Cream',
    
    # Ukrainian
    '—á–æ—Ä–Ω–∏–π': 'Black',
    '–±—ñ–ª–∏–π': 'White',
    '—Å—ñ—Ä–∏–π': 'Gray',
    '—Å–∏–Ω—ñ–π': 'Blue',
    '—á–µ—Ä–≤–æ–Ω–∏–π': 'Red',
    '–∑–µ–ª–µ–Ω–∏–π': 'Green',
    '–∂–æ–≤—Ç–∏–π': 'Yellow',
    '–ø–æ–º–∞—Ä–∞–Ω—á–µ–≤–∏–π': 'Orange',
    '—Ä–æ–∂–µ–≤–∏–π': 'Pink',
    '—Ñ—ñ–æ–ª–µ—Ç–æ–≤–∏–π': 'Purple',
    '–∫–æ—Ä–∏—á–Ω–µ–≤–∏–π': 'Brown',
    '–±–µ–∂–µ–≤–∏–π': 'Beige',
    '—Ç–µ–º–Ω–æ-—Å–∏–Ω—ñ–π': 'Navy',
    '–±–æ—Ä–¥–æ–≤–∏–π': 'Maroon',
}

TYPE_MAPPINGS = {
    # English
    'jackets': 'jackets',
    'jacket': 'jackets',
    'hoodies': 'hoodies',
    'hoodie': 'hoodies',
    'tshirts': 'T-shirts',
    'tshirt': 'T-shirts',
    't-shirts': 'T-shirts',
    't-shirt': 'T-shirts',
    'pants': 'pants',
    'pant': 'pants',
    'jeans': 'jeans',
    'jean': 'jeans',
    'shorts': 'shorts',
    'short': 'shorts',
    'shoes': 'shoes',
    'shoe': 'shoes',
    'accessories': 'accessories',
    'accessory': 'accessories',
    
    # Ukrainian
    '–∫—É—Ä—Ç–∫–∏': 'jackets',
    '–∫—É—Ä—Ç–∫–∞': 'jackets',
    '—Ö—É–¥—ñ': 'hoodies',
    '—Ñ—É—Ç–±–æ–ª–∫–∏': 'T-shirts',
    '—Ñ—É—Ç–±–æ–ª–∫–∞': 'T-shirts',
    '—à—Ç–∞–Ω–∏': 'pants',
    '–¥–∂–∏–Ω—Å–∏': 'jeans',
    '–¥–∂–∏–Ω—Å': 'jeans',
    '—à–æ—Ä—Ç–∏': 'shorts',
    '–≤–∑—É—Ç—Ç—è': 'shoes',
    '–∞–∫—Å–µ—Å—É–∞—Ä–∏': 'accessories',
    '–∞–∫—Å–µ—Å—É–∞—Ä': 'accessories',
}

def detect_search_filter(query: str) -> dict:
    """
    Detect if search query is a color or product type
    Returns: {'type': 'color'|'category'|None, 'value': str|None}
    """
    if not query:
        return {'type': None, 'value': None}
    
    normalized = query.strip().lower()
    
    # Check color
    if normalized in COLOR_MAPPINGS:
        return {'type': 'color', 'value': COLOR_MAPPINGS[normalized]}
    
    # Check type
    if normalized in TYPE_MAPPINGS:
        return {'type': 'category', 'value': TYPE_MAPPINGS[normalized]}
    
    return {'type': None, 'value': None}
```

#### 2. –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –≤ –µ–Ω–¥–ø–æ—ñ–Ω—Ç—ñ `/api/v1/items/search`

```python
@router.get("/search")
async def search_products(
    q: Optional[str] = None,
    color: Optional[str] = None,
    type: Optional[str] = None,
    # ... —ñ–Ω—à—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏
):
    # –Ø–∫—â–æ —î —Ç–µ–∫—Å—Ç–æ–≤–∏–π –∑–∞–ø–∏—Ç, –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —á–∏ —Ü–µ –Ω–µ –∫–æ–ª—ñ—Ä/—Ç–∏–ø
    if q and not color and not type:
        detected = detect_search_filter(q)
        
        if detected['type'] == 'color':
            color = detected['value']
            q = None  # –û—á–∏—Å—Ç–∏—Ç–∏ —Ç–µ–∫—Å—Ç–æ–≤–∏–π –ø–æ—à—É–∫
        elif detected['type'] == 'category':
            type = detected['value']
            q = None  # –û—á–∏—Å—Ç–∏—Ç–∏ —Ç–µ–∫—Å—Ç–æ–≤–∏–π –ø–æ—à—É–∫
    
    # –î–∞–ª—ñ –≤–∞—à–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞ –ª–æ–≥—ñ–∫–∞ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó
    query = db.query(Product)
    
    if q:
        query = query.filter(Product.name.ilike(f"%{q}%"))
    if color:
        query = query.filter(Product.color == color)
    if type:
        query = query.filter(Product.category == type)
    
    # ...
```

### –û–ø—Ü—ñ—è 3: –î–æ–¥–∞—Ç–∏ –∞–Ω–∞–ª—ñ—Ç–∏–∫—É

–ú–æ–∂–Ω–∞ –ª–æ–≥—É–≤–∞—Ç–∏, –∫–æ–ª–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ —à—É–∫–∞—é—Ç—å –ø–æ –∫–æ–ª—å–æ—Ä–∞—Ö/—Ç–∏–ø–∞—Ö:

```python
# analytics/search_tracking.py

def log_search_event(user_id, query, detected_filter):
    """
    Track search patterns for analytics
    """
    event = {
        'user_id': user_id,
        'query': query,
        'filter_type': detected_filter.get('type'),
        'filter_value': detected_filter.get('value'),
        'timestamp': datetime.utcnow()
    }
    
    # –ó–±–µ—Ä–µ–≥—Ç–∏ –≤ –ë–î –∞–±–æ –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –≤ –∞–Ω–∞–ª—ñ—Ç–∏–∫—É
    analytics_db.insert('search_events', event)
```

## üìä –ü–µ—Ä–µ–≤–∞–≥–∏ –Ω–æ–≤–æ—ó —Ñ—É–Ω–∫—Ü—ñ—ó

1. **–®–≤–∏–¥—à–∏–π –¥–æ—Å—Ç—É–ø –¥–æ —Ç–æ–≤–∞—Ä—ñ–≤** - –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤—ñ–¥—Ä–∞–∑—É –±–∞—á–∏—Ç—å –≤—ñ–¥—Ñ—ñ–ª—å—Ç—Ä–æ–≤–∞–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏
2. **–Ü–Ω—Ç—É—ó—Ç–∏–≤–Ω—ñ—Å—Ç—å** - –ø—Ä–∏—Ä–æ–¥–Ω–∞ –º–æ–≤–∞ –ø–æ—à—É–∫—É
3. **–ë–∞–≥–∞—Ç–æ–º–æ–≤–Ω—ñ—Å—Ç—å** - –ø—Ä–∞—Ü—é—î —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é —Ç–∞ –∞–Ω–≥–ª—ñ–π—Å—å–∫–æ—é
4. **SEO** - —á–∏—Å—Ç—ñ—à—ñ URL –∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ —Ñ—ñ–ª—å—Ç—Ä—ñ–≤
5. **–ê–Ω–∞–ª—ñ—Ç–∏–∫–∞** - –ª–µ–≥—à–µ –≤—ñ–¥—Å–ª—ñ–¥–∫–æ–≤—É–≤–∞—Ç–∏ –ø–æ–ø—É–ª—è—Ä–Ω—ñ –∫–æ–ª—å–æ—Ä–∏/–∫–∞—Ç–µ–≥–æ—Ä—ñ—ó

## üß™ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

### –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ä–æ–±–æ—Ç—É:

1. –í—ñ–¥–∫—Ä–∏—Ç–∏ –ø–æ—à—É–∫ (–∫–Ω–æ–ø–∫–∞ Search –∞–±–æ –∫–Ω–æ–ø–∫–∞ –ø–æ—à—É–∫—É –≤ —Ö–µ–¥–µ—Ä—ñ)
2. –í–≤–µ—Å—Ç–∏ –∫–æ–ª—ñ—Ä: `black`, `red`, `—á–æ—Ä–Ω–∏–π`, `—Å–∏–Ω—ñ–π`
3. –ù–∞—Ç–∏—Å–Ω—É—Ç–∏ Enter –∞–±–æ "View All Results"
4. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —â–æ –≤—ñ–¥–∫—Ä–∏–ª–∞—Å—å —Å—Ç–æ—Ä—ñ–Ω–∫–∞ `/products?color=XXX` –∑ –∞–∫—Ç–∏–≤–Ω–∏–º —Ñ—ñ–ª—å—Ç—Ä–æ–º
5. –ü–æ–≤—Ç–æ—Ä–∏—Ç–∏ –∑ —Ç–∏–ø–∞–º–∏: `jacket`, `shoes`, `–∫—É—Ä—Ç–∫–∞`, `–≤–∑—É—Ç—Ç—è`

### –û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
- ‚úÖ –°—Ç–æ—Ä—ñ–Ω–∫–∞ Products –≤—ñ–¥–∫—Ä–∏–≤–∞—î—Ç—å—Å—è –∑ –∞–∫—Ç–∏–≤–Ω–∏–º —Ñ—ñ–ª—å—Ç—Ä–æ–º
- ‚úÖ –í—ñ–¥–æ–±—Ä–∞–∂–∞—é—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ —Ç–æ–≤–∞—Ä–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ–≥–æ –∫–æ–ª—å–æ—Ä—É/—Ç–∏–ø—É
- ‚úÖ –§—ñ–ª—å—Ç—Ä –≤ –ª—ñ–≤–æ–º—É —Å–∞–π–¥–±–∞—Ä—ñ –∞–∫—Ç–∏–≤–Ω–∏–π (–≥–∞–ª–æ—á–∫–∞)
- ‚úÖ URL –º—ñ—Å—Ç–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä `?color=XXX` –∞–±–æ `?type=XXX`

## üìù –î–æ–¥–∞—Ç–∫–æ–≤—ñ –Ω–æ—Ç–∞—Ç–∫–∏

- –í—Å—ñ –º–∞–ø–ø—ñ–Ω–≥–∏ –∫–æ–ª—å–æ—Ä—ñ–≤ —ñ —Ç–∏–ø—ñ–≤ –∑–Ω–∞—Ö–æ–¥—è—Ç—å—Å—è –≤ `src/utils/searchFilters.ts`
- –Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –¥–æ–¥–∞—Ç–∏ –Ω–æ–≤—ñ –∫–æ–ª—å–æ—Ä–∏ - –æ–Ω–æ–≤—ñ—Ç—å `COLOR_MAPPINGS`
- –Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –¥–æ–¥–∞—Ç–∏ –Ω–æ–≤—ñ —Ç–∏–ø–∏ - –æ–Ω–æ–≤—ñ—Ç—å `TYPE_MAPPINGS`
- –§—É–Ω–∫—Ü—ñ—è case-insensitive (–Ω–µ —á—É—Ç–ª–∏–≤–∞ –¥–æ —Ä–µ–≥—ñ—Å—Ç—Ä—É)
- –ü—ñ–¥—Ç—Ä–∏–º—É—î –æ–¥–Ω–∏–Ω—É/–º–Ω–æ–∂–∏–Ω—É (jacket/jackets, –∫—É—Ä—Ç–∫–∞/–∫—É—Ä—Ç–∫–∏)

## ‚ùì –ü–∏—Ç–∞–Ω–Ω—è?

–Ø–∫—â–æ –≤–∏–Ω–∏–∫–Ω—É—Ç—å –ø–∏—Ç–∞–Ω–Ω—è —â–æ–¥–æ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó, –ø–∏—à–∏! –§—Ä–æ–Ω—Ç–µ–Ω–¥ –≥–æ—Ç–æ–≤–∏–π —ñ –ø—Ä–∞—Ü—é—î –Ω–∞ 100%.
